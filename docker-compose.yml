version: '3.8'

services:
  frontend:
    build:
      context: .
      dockerfile: packages/frontend/Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_CHAIN_ID=1
      - NEXT_PUBLIC_RPC_URL=https://eth.llamarpc.com
    depends_on:
      - relayer
    networks:
      - tambr-network

  relayer:
    build:
      context: .
      dockerfile: packages/relayer/Dockerfile
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - RELAYER_PRIVATE_KEY=${RELAYER_PRIVATE_KEY}
      - CHAIN_ID=1
      - RPC_URL=https://eth.llamarpc.com
      - VERIFYING_CONTRACT=${VERIFYING_CONTRACT}
    networks:
      - tambr-network

  # Optional: Database service (if needed)
  # postgres:
  #   image: postgres:15-alpine
  #   environment:
  #     - POSTGRES_DB=tambr
  #     - POSTGRES_USER=tambr
  #     - POSTGRES_PASSWORD=${DB_PASSWORD}
  #   volumes:
  #     - postgres_data:/var/lib/postgresql/data
  #   networks:
  #     - tambr-network

networks:
  tambr-network:
    driver: bridge

# volumes:
#   postgres_data:
